<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Introductie & PHPUnit - Quality Assurance - Laravel 12</title>
    <link rel="stylesheet" href="../../../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="../../../script.js" defer></script>
</head>
<body>
<div class="top-bar"><div class="top-bar-content"><div class="nav-group"><a href="../module12/m12-7.html">« Services & Features</a></div><div class="nav-group theme-switcher"><select id="theme-switcher"><option value="blue">Blauw</option></select></div></div></div>

<div class="container">
    <div class="header-nav-block">
        <header>
            <h1>Quality Assurance</h1>
            <p>Codekwaliteit, testen met PHPUnit, Pest & Dusk, en debugging.</p>
        </header>
        <nav>
            <ul>
                <li><a href="m13-1.html" class="active">Introductie & PHPUnit</a></li>
                <li><a href="m13-2.html">Unit vs Feature Tests</a></li>
                <li><a href="m13-3.html">Introductie Pest</a></li>
                <li><a href="m13-4.html">Unit & Feature Tests (Pest)</a></li>
                <li><a href="m13-5.html">Database Testing & Seeding</a></li>
                <li><a href="m13-6.html">Mocking & Spies</a></li>
                <li><a href="m13-7.html">Browser Testing (Dusk)</a></li>
                <li><a href="m13-8.html">Static Analysis & Debugging</a></li>
            </ul>
        </nav>
    </div>

    <main>
        <h2>Waarom testen we code?</h2>
        <p>Als beginnende developer test je vaak handmatig. Je schrijft code, opent de browser, vult een formulier in en kijkt of het werkt. Dit werkt prima voor kleine projecten, maar zodra je applicatie groeit, wordt dit onhoudbaar en foutgevoelig.</p>
        <p>Geautomatiseerde tests zijn scripts die jouw code controleren. Ze geven je het vertrouwen om te <strong>refactoren</strong> (code verbeteren) zonder dat je bang hoeft te zijn dat je bestaande functionaliteit sloopt (regressie).</p>

        <h3>De Test Piramide: Unit vs Feature</h3>
        <p>In Laravel onderscheiden we twee hoofdsoorten tests. Het verschil zit hem in <strong>scope</strong> (wat test je?) en <strong>snelheid</strong>.</p>
        <ul>
            <li>
                <strong>Unit Tests:</strong> Testen een klein, geïsoleerd stukje logica (bijv. een BTW-berekening in een Service class).
                <br><em>Scope:</em> Extreem klein. Raakt GEEN database, GEEN internet, GEEN framework features.
                <br><em>Snelheid:</em> Razendsnel (duizenden tests in milliseconden).
            </li>
            <li>
                <strong>Feature Tests:</strong> Testen een groter geheel (bijv. "Een gebruiker kan inloggen").
                <br><em>Scope:</em> Breed. Raakt de database, controllers, routing en validatie.
                <br><em>Snelheid:</em> Trager, omdat Laravel en de database moeten opstarten.
            </li>
        </ul>

        <h3>PHPUnit: De Basis</h3>
        <p>PHPUnit is de motor onder alle Laravel tests. Zelfs als je nieuwere tools zoals Pest gebruikt, draait PHPUnit vaak nog op de achtergrond. Een test in PHPUnit is een <strong>Class</strong> die overerft van <code>TestCase</code>.</p>

        <h3>Een Test Aanmaken</h3>
        <p>Je maakt een testbestand aan via Artisan. Standaard maakt Laravel een <em>Feature</em> test aan.</p>
        <div class="note-box">Terminal</div>
        <pre><code class="language-bash">php artisan make:test UserTest</code></pre>

        <h3>Anatomie van een Test Class</h3>
        <p>Laten we kijken naar de structuur. Een testbestand begint met de namespace en imports. Belangrijk is dat je de <code>RefreshDatabase</code> trait gebruikt als je met de database werkt. Dit zorgt ervoor dat elke test met een schone lei begint (transacties).</p>

        <div class="note-box">Bestand: <code>tests/Feature/UserTest.php</code></div>
        <pre><code class="language-php">
namespace Tests\Feature;

use Tests\TestCase;
use App\Models\User;
use Illuminate\Foundation\Testing\RefreshDatabase;

class UserTest extends TestCase
{
    // Zorgt voor database transacties (snel!)
    use RefreshDatabase;
        </code></pre>

        <h3>De `setUp` Methode</h3>
        <p>Elke PHPUnit class heeft een speciale methode: <code>setUp()</code>. Deze wordt uitgevoerd <strong>vóór elke test</strong> in het bestand. Dit is de plek om algemene data klaar te zetten, zoals seeders.</p>

        <pre><code class="language-php">
    protected function setUp(): void
    {
        parent::setUp(); // Altijd de parent aanroepen!

        // Hier kun je algemene data klaarzetten (Seeding)
        // Bijvoorbeeld: permissies inladen voor elke test
        $this->seed(RolesAndPermissionsSeeder::class);
    }
        </code></pre>

        <h3>Een Test Methode (AAA-principe)</h3>
        <p>Een test methode volgt vaak het <strong>AAA-principe</strong>: Arrange (zet klaar), Act (doe de actie), Assert (controleer de uitkomst). Hier testen we of de homepagina werkt voor een ingelogde gebruiker.</p>

        <pre><code class="language-php">
    public function test_homepage_is_accessible_for_user(): void
    {
        // 1. Arrange (Klaarzetten)
        $user = User::factory()->create();

        // 2. Act (Doe de actie)
        // We loggen in als de user en bezoeken de homepagina
        $response = $this->actingAs($user)->get('/');

        // 3. Assert (Controleer de uitkomst)
        $response->assertStatus(200);
    }
} // Einde van class
        </code></pre>

        <h3>Tests Uitvoeren</h3>
        <p>Om je tests te draaien gebruik je het commando <code>php artisan test</code>. Dit commando geeft een mooi overzicht van welke tests geslaagd of gefaald zijn.</p>
        <div class="note-box">Terminal</div>
        <pre><code class="language-bash">php artisan test</code></pre>
    </main>
</div>
<footer><div class="footer-content"><p>&copy; 2025 Techniek College Rotterdam</p></div></footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>