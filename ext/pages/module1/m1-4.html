<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controller Index - Laravel 12 Module 1</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../style.css">
</head>
<body>

<header>
    <a href="../../index.html" class="logo">
        <svg width="30" height="30" viewBox="0 0 100 100" fill="currentColor"><path d="M50 0L10 20L10 80L50 100L90 80L90 20L50 0Z"/></svg>
        Laravel 12
    </a>
    <div class="header-controls">
        <button class="btn-control" id="color-toggle">ðŸŽ¨ Kleur</button>
        <button class="btn-control" id="theme-toggle">ðŸŒ“ Thema</button>
        <button class="mobile-menu-btn" id="menu-toggle">â˜°</button>
    </div>
</header>

<div class="layout-wrapper">
    <nav class="sidebar-left">

        <div class="nav-group">
            <h3>Cursus Modules</h3>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 1: Basis CRUD
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu" style="display:block;">
                    <li><a href="m1-1.html">Model & Migration</a></li>
                    <li><a href="m1-2.html">Factory & Seeding</a></li>
                    <li><a href="m1-3.html">Layouts & Tailwind</a></li>
                    <li><a href="m1-4.html" class="current">Controller Index</a></li>
                    <li><a href="m1-5.html">Create & Store</a></li>
                    <li><a href="m1-6.html">Validatie & Flash</a></li>
                    <li><a href="m1-7.html">Detailpagina (Show)</a></li>
                    <li><a href="m1-8.html">Edit & Update</a></li>
                    <li><a href="m1-9.html">Delete & Destroy</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 2: Users & Security
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module2/m2-1.html">Publieke Layout</a></li>
                    <li><a href="../module2/m2-2.html">Simpele Publieke Pagina</a></li>
                    <li><a href="../module2/m2-3.html">Roles & Permissions</a></li>
                    <li><a href="../module2/m2-4.html">Aanmaken van Users</a></li>
                    <li><a href="../module2/m2-5.html">Middleware bij Routes</a></li>
                    <li><a href="../module2/m2-6.html">Rolgebaseerde Toegang</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 3: Advanced Admin
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module3/m3-1.html">Models & Migrations</a></li>
                    <li><a href="../module3/m3-2.html">Factories met Relaties</a></li>
                    <li><a href="../module3/m3-3.html">Seeders met Relaties</a></li>
                    <li><a href="../module3/m3-4.html">Index & Eager Loading</a></li>
                    <li><a href="../module3/m3-5.html">Permissions</a></li>
                    <li><a href="../module3/m3-6.html">Create & Dropdowns</a></li>
                    <li><a href="../module3/m3-7.html">Store & Validatie</a></li>
                    <li><a href="../module3/m3-8.html">Show & Relaties</a></li>
                    <li><a href="../module3/m3-9.html">Edit & Pre-select</a></li>
                    <li><a href="../module3/m3-10.html">Update & Logica</a></li>
                    <li><a href="../module3/m3-11.html">Delete View</a></li>
                    <li><a href="../module3/m3-12.html">Destroy & Constraints</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 4: Webshop Features
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module4/m4-1.html">Publieke Productpagina</a></li>
                    <li><a href="../module4/m4-2.html">De Product Show</a></li>
                    <li><a href="../module4/m4-3.html">Reviews Setup (DB)</a></li>
                    <li><a href="../module4/m4-4.html">Reviews Tonen</a></li>
                    <li><a href="../module4/m4-5.html">Reviews Plaatsen</a></li>
                    <li><a href="../module4/m4-6.html">Winkelwagen Setup</a></li>
                    <li><a href="../module4/m4-7.html">Winkelwagen Tonen</a></li>
                    <li><a href="../module4/m4-8.html">Winkelwagen Wijzigen</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 5: Orders & Validatie
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module5/m5-1.html">Orders Structuur</a></li>
                    <li><a href="../module5/m5-2.html">Order Seeds</a></li>
                    <li><a href="../module5/m5-3.html">Orders Opslaan</a></li>
                    <li><a href="../module5/m5-4.html">Orders Tonen</a></li>
                    <li><a href="../module5/m5-5.html">Order naar PDF</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <h1>Resource Controller & Index</h1>

        <h2 id="mvc">Het MVC-Principe</h2>
        <p>MVC staat voor Model-View-Controller. Zoals je in het plaatje hieronder kunt voorstellen, werkt de <strong>Controller</strong> samen met het <strong>Model</strong> (de database) en stuurt hij de <strong>View</strong> (de pagina) aan. Eigenlijk is de controller de 'regelneef' die alles coÃ¶rdineert.</p>

        <h2 id="resource-controller">Aanmaken van de Resource Controller</h2>
        <p>We gaan nu zo'n resource controller maken. Als je nieuwsgierig bent naar alle opties, kun je in de terminal <code>php artisan help make:controller</code> typen.</p>

        <p>Voor onze webshop willen we een controller die gekoppeld is aan ons <code>Category</code> model. Daarnaast is het netjes om alle beheer-controllers in een apart mapje 'Admin' te zetten. Zo houden we de code overzichtelijk.</p>

        <div class="info-box" style="background: var(--bg-content); border: 1px solid var(--border-color); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
            <strong>Commando uitleg:</strong><br>
            We gebruiken de optie <code>--model=Category</code>. Hierdoor weet Laravel direct dat deze controller voor categorieÃ«n bedoeld is en vult hij alvast wat code voor ons in. Door <code>Admin/</code> voor de naam te zetten, plaatsen we het bestand in de juiste map.
        </div>

        <pre><code class="language-bash">php artisan make:controller --model=Category Admin/CategoryController</code></pre>

        <h3 id="naming-conventions">Naamgeving (Conventies)</h3>
        <p>In Laravel is het belangrijk om je aan de standaarden te houden. Dit maakt je code voorspelbaar voor anderen (en voor Laravel zelf). Hier zijn de regels op een rijtje:</p>
        <ul>
            <li><strong>Model:</strong> Enkelvoud, UpperCamelCase (bijv. <code>Category</code>)</li>
            <li><strong>Tabel:</strong> Meervoud, lowercase (bijv. <code>categories</code>)</li>
            <li><strong>Factory:</strong> Modelnaam + Factory (bijv. <code>CategoryFactory</code>)</li>
            <li><strong>Seeder:</strong> Modelnaam + Seeder (bijv. <code>CategorySeeder</code>)</li>
            <li><strong>Controller:</strong> Modelnaam + Controller (bijv. <code>CategoryController</code>)</li>
        </ul>

        <p>Als je het bestand <code>app/Http/Controllers/Admin/CategoryController.php</code> opent, zie je dat Laravel al zeven methodes heeft aangemaakt. Elke methode heeft een eigen taak binnen de CRUD:</p>
        <ul>
            <li><code>index</code>: Toont een lijst van alle categorieÃ«n.</li>
            <li><code>create</code>: Toont het formulier om een nieuwe categorie aan te maken.</li>
            <li><code>store</code>: Verwerkt het formulier en slaat de nieuwe categorie op.</li>
            <li><code>show</code>: Toont de details van Ã©Ã©n specifieke categorie.</li>
            <li><code>edit</code>: Toont het formulier om een bestaande categorie te wijzigen.</li>
            <li><code>update</code>: Verwerkt de wijzigingen en slaat ze op.</li>
            <li><code>destroy</code>: Verwijdert een categorie uit de database.</li>
        </ul>

        <h3 id="namespace-warning">Let op: Namespaces</h3>
        <p>Heb je de controller per ongeluk niet in de <code>Admin</code> map aangemaakt en verplaats je het bestand handmatig? Let dan goed op de <strong>namespace</strong> bovenin het bestand. Deze moet kloppen met de mapstructuur:</p>
        <pre><code class="language-php">namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller; // Vergeet deze niet als je in een submap zit!</code></pre>
        <p>Als je namespaces aanpast, moet je vaak even <code>composer dump-autoload</code> draaien in de terminal zodat Laravel alles weer kan vinden.</p>

        <h2 id="routing">Routing Instellen</h2>
        <p>De controller is er, maar de bezoeker kan er nog niet bij. Laravel gebruikt <strong>routes</strong> om een URL (zoals <code>/admin/categories</code>) te koppelen aan een controller.</p>

        <p>Open <code>routes/web.php</code>. We kunnen voor elke methode (index, create, store, etc.) een aparte route schrijven, maar dat is veel werk. Gelukkig heeft Laravel een snelkoppeling: de <strong>Resource Route</strong>.</p>

        <pre><code class="language-php">
use App\Http\Controllers\Admin\CategoryController;
use Illuminate\Support\Facades\Route;

// Dit maakt in Ã©Ã©n keer alle 7 routes aan voor de CRUD
Route::resource('admin/categories', CategoryController::class);
        </code></pre>

        <p>Met deze ene regel krijg je automatisch ook 'named routes'. Dit zijn namen die we in onze code gebruiken om naar een URL te verwijzen. Dat is handig, want als de URL ooit verandert, hoef je de naam niet overal aan te passen. Een paar voorbeelden:</p>
        <ul>
            <li><code>admin.categories.index</code> (de lijst)</li>
            <li><code>admin.categories.create</code> (het aanmaakformulier)</li>
            <li><code>admin.categories.edit</code> (het wijzigformulier)</li>
        </ul>

        <h2 id="index-controller">De Index Methode Uitwerken</h2>
        <p>We beginnen met het overzicht. In de <code>index</code> methode van de controller moeten we twee dingen doen:</p>
        <ol>
            <li>Alle categorieÃ«n ophalen uit de database.</li>
            <li>Deze data doorgeven aan de view (de pagina).</li>
        </ol>

        <p>Omdat we Eloquent gebruiken, hoeven we geen ingewikkelde SQL-query's te schrijven. We gebruiken gewoon het Model.</p>

        <pre><code class="language-php">
namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use App\Models\Category; // Importeer het Model!
use Illuminate\View\View; // Importeer de View class voor type hinting

class CategoryController extends Controller
{
    // We geven met ': View' aan dat deze functie een View teruggeeft
    public function index(): View
    {
        // 1. Haal alles op
        $categories = Category::all();

        // 2. Geef de view terug en stuur de data mee
        // We gebruiken punt-notatie voor de mappen: admin/categories/index.blade.php
        return view('admin.categories.index', [
            'categories' => $categories
        ]);
    }
}
        </code></pre>

        <h2 id="index-view">De View Maken</h2>
        <p>De controller verwijst naar <code>admin.categories.index</code>. Die bestaat nog niet, dus die moeten we maken. Let op de mappenstructuur in <code>resources/views</code>:</p>
        <ol>
            <li>Maak een map <code>admin</code>.</li>
            <li>Maak daarin een map <code>categories</code>.</li>
            <li>Maak daarin het bestand <code>index.blade.php</code>.</li>
        </ol>

        <p>In dit bestand gebruiken we de <code>layoutadmin</code> die we eerder hebben gemaakt. We 'vullen' de plekken die we met <code>@yield</code> hebben aangegeven.</p>

        <pre><code class="language-html">
@extends('layouts.layoutadmin')

@section('topmenu')
    &lt;div class="flex justify-between items-center mb-6"&gt;
        &lt;h2 class="text-2xl font-bold text-gray-800"&gt;CategorieÃ«n Overzicht&lt;/h2&gt;
        &lt;a href="{{ route('admin.categories.create') }}" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"&gt;
            Nieuwe Categorie
        &lt;/a&gt;
    &lt;/div&gt;
@endsection

@section('content')
    &lt;div class="bg-white rounded-lg shadow overflow-hidden"&gt;
        &lt;table class="min-w-full divide-y divide-gray-200"&gt;
            &lt;thead class="bg-gray-50"&gt;
                &lt;tr&gt;
                    &lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"&gt;ID&lt;/th&gt;
                    &lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"&gt;Naam&lt;/th&gt;
                    &lt;th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"&gt;Acties&lt;/th&gt;
                &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody class="bg-white divide-y divide-gray-200"&gt;
                @foreach($categories as $category)
                    &lt;tr&gt;
                        &lt;td class="px-6 py-4"&gt;{{ $category-&gt;id }}&lt;/td&gt;
                        &lt;td class="px-6 py-4"&gt;{{ $category-&gt;name }}&lt;/td&gt;
                        &lt;td class="px-6 py-4 text-sm"&gt;
                            &lt;a href="{{ route('admin.categories.edit', $category) }}" class="text-indigo-600 hover:text-indigo-900"&gt;Wijzig&lt;/a&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                @endforeach
            &lt;/tbody&gt;
        &lt;/table&gt;
    &lt;/div&gt;
@endsection
        </code></pre>

        <h2 id="flow">Hoe werkt het nu precies? (Van URL naar Scherm)</h2>
        <p>Het is belangrijk om te snappen wat er op de achtergrond gebeurt als jij naar de pagina surft. Dit zijn de stappen:</p>
        <ol>
            <li>Jij typt <code>localhost/admin/categories</code> in de browser.</li>
            <li>Laravel kijkt in <code>routes/web.php</code> en ziet dat deze URL bij de <code>CategoryController</code> hoort.</li>
            <li>Omdat het een standaard 'GET' verzoek is, start Laravel de <code>index()</code> methode in die controller.</li>
            <li>De controller vraagt aan het Model: "Geef mij alle categorieÃ«n".</li>
            <li>Het Model haalt de data uit de database en geeft het terug aan de controller.</li>
            <li>De controller pakt de View erbij, stopt de data erin en stuurt de complete HTML pagina naar jouw browser.</li>
        </ol>

    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../script.js"></script>
</body>
</html>