<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model & Migration - Laravel 12 Module 1</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../style.css">
</head>
<body>

<header>
    <a href="../../index.html" class="logo">
        <svg width="30" height="30" viewBox="0 0 100 100" fill="currentColor"><path d="M50 0L10 20L10 80L50 100L90 80L90 20L50 0Z"/></svg>
        Laravel 12
    </a>
    <div class="header-controls">
        <button class="btn-control" id="color-toggle">ðŸŽ¨ Kleur</button>
        <button class="btn-control" id="theme-toggle">ðŸŒ“ Thema</button>
        <button class="mobile-menu-btn" id="menu-toggle">â˜°</button>
    </div>
</header>

<div class="layout-wrapper">
    <nav class="sidebar-left">

        <div class="nav-group">
            <h3>Cursus Modules</h3>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 1: Basis CRUD
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu" style="display:block;"> <li><a href="m1-1.html" class="current">Model & Migration</a></li>
                    <li><a href="m1-2.html">Factory & Seeding</a></li>
                    <li><a href="m1-3.html">Layouts & Tailwind</a></li>
                    <li><a href="m1-4.html">Controller Index</a></li>
                    <li><a href="m1-5.html">Create & Store</a></li>
                    <li><a href="m1-6.html">Validatie & Flash</a></li>
                    <li><a href="m1-7.html">Detailpagina (Show)</a></li>
                    <li><a href="m1-8.html">Edit & Update</a></li>
                    <li><a href="m1-9.html">Delete & Destroy</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 2: Users & Security
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module2/m2-1.html">Publieke Layout</a></li>
                    <li><a href="../module2/m2-2.html">Simpele Publieke Pagina</a></li>
                    <li><a href="../module2/m2-3.html">Roles & Permissions</a></li>
                    <li><a href="../module2/m2-4.html">Aanmaken van Users</a></li>
                    <li><a href="../module2/m2-5.html">Middleware bij Routes</a></li>
                    <li><a href="../module2/m2-6.html">Rolgebaseerde Toegang</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 3: Advanced Admin
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module3/m3-1.html">Models & Migrations</a></li>
                    <li><a href="../module3/m3-2.html">Factories met Relaties</a></li>
                    <li><a href="../module3/m3-3.html">Seeders met Relaties</a></li>
                    <li><a href="../module3/m3-4.html">Index & Eager Loading</a></li>
                    <li><a href="../module3/m3-5.html">Permissions</a></li>
                    <li><a href="../module3/m3-6.html">Create & Dropdowns</a></li>
                    <li><a href="../module3/m3-7.html">Store & Validatie</a></li>
                    <li><a href="../module3/m3-8.html">Show & Relaties</a></li>
                    <li><a href="../module3/m3-9.html">Edit & Pre-select</a></li>
                    <li><a href="../module3/m3-10.html">Update & Logica</a></li>
                    <li><a href="../module3/m3-11.html">Delete View</a></li>
                    <li><a href="../module3/m3-12.html">Destroy & Constraints</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 4: Webshop Features
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module4/m4-1.html">Publieke Productpagina</a></li>
                    <li><a href="../module4/m4-2.html">De Product Show</a></li>
                    <li><a href="../module4/m4-3.html">Reviews Setup (DB)</a></li>
                    <li><a href="../module4/m4-4.html">Reviews Tonen</a></li>
                    <li><a href="../module4/m4-5.html">Reviews Plaatsen</a></li>
                    <li><a href="../module4/m4-6.html">Winkelwagen Setup</a></li>
                    <li><a href="../module4/m4-7.html">Winkelwagen Tonen</a></li>
                    <li><a href="../module4/m4-8.html">Winkelwagen Wijzigen</a></li>
                </ul>
            </div>

            <div class="nav-item-container">
                <button class="nav-toggle">
                    Module 5: Orders & Validatie
                    <svg class="chevron" viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                </button>
                <ul class="submenu">
                    <li><a href="../module5/m5-1.html">Orders Structuur</a></li>
                    <li><a href="../module5/m5-2.html">Order Seeds</a></li>
                    <li><a href="../module5/m5-3.html">Orders Opslaan</a></li>
                    <li><a href="../module5/m5-4.html">Orders Tonen</a></li>
                    <li><a href="../module5/m5-5.html">Order naar PDF</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <h1>Introductie, Model & Migration</h1>
        <p>Welkom bij Module 1. In deze lessenserie ga je stap voor stap een simpele webshop bouwen voor spellen. We beginnen bij de basis: de database en de modellen.</p>

        <h2 id="casus">Casus Beschrijving</h2>
        <p>In deze lessenserie ga je een simpele webshop maken voor spellen. Hierbij kunnen gebruikers:</p>
        <ul>
            <li>Spellen bekijken</li>
            <li>Details van een spel bekijken</li>
            <li>Review achterlaten over een spel</li>
            <li>Een spel kopen</li>
        </ul>
        <p>Een beheerder moet alles kunnen toevoegen, wijzigen en verwijderen. Hiervoor zijn er verschillende admin-secties nodig (Categorie, Product, Price, Order, Review, User).</p>

        <div class="info-box" style="background: var(--bg-content); border: 1px solid var(--border-color); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem;">
            <strong>Let op:</strong> Naast het project dat stap voor stap wordt uitgelegd, zijn er ook oefenopdrachten. Laravel leer je niet door alleen te kijken; je zult het zelf moeten uitvoeren. De oefenopdrachten gaan over het maken van een <em>Projecttool</em> voor studenten.
        </div>

        <h2 id="model">Het Model</h2>
        <p>Laravel gebruikt het <strong>MVC-principe</strong> (Model-View-Controller). De Model zorgt dat alles met Data geregeld wordt. Let erop dat dit niet standaard alleen met een database is, al gebruiken we het daar in het begin wel veel voor.</p>

        <p>Laravel gebruikt Eloquent, een Object Relational Mapper (ORM). Dit betekent dat voor elke tabel in de database een Model verantwoordelijk is. Via dit Model communiceren we met de tabel (lezen, schrijven, updaten, verwijderen).</p>

        <h3 id="naming-conventions">Naming Conventions</h3>
        <p>In Laravel zijn strikte regels over naamgeving. Het is belangrijk dat je deze volgt om alle ingebouwde functionaliteit te kunnen gebruiken.</p>

        <div style="background: var(--primary-light, #fef2f2); padding: 1.5rem; border-radius: 0.5rem; border-left: 4px solid #ef3b2d; color: var(--text-main, #1e293b); margin-bottom: 1.5rem;">
            <strong>Standaard Conventies:</strong>
            <ul style="margin-top: 0.5rem; margin-bottom: 0;">
                <li><strong>Model:</strong> Enkelvoud, UpperCamelCase (bijv. <code>Category</code> of <code>Student</code>)</li>
                <li><strong>Tabel:</strong> Meervoud, lowercase (bijv. <code>categories</code> of <code>students</code>)</li>
            </ul>
        </div>

        <h3 id="create-model">Model Aanmaken</h3>
        <p>We gebruiken Artisan commando's in de terminal om bestanden aan te maken. Voor het maken van de Category model gebruiken we:</p>

        <pre><code class="language-bash">php artisan make:model Category</code></pre>

        <p>Het bestand <code>Category.php</code> wordt aangemaakt in de map <code>app/Models</code>. Voor nu hoeven we nog niets in dit bestand aan te passen.</p>

        <h2 id="migration">Migrations</h2>
        <p>Een migration is als versiebeheer voor je database. In plaats van SQL-dumps rond te sturen binnen een team, beschrijf je de database structuur in code (PHP). Hierdoor kun je wijzigingen makkelijk delen en terugdraaien.</p>

        <h3 id="naming-migration">Migration Naamgeving</h3>
        <p>Laravel hanteert naming conventions voor migrations zodat de intentie duidelijk is:</p>
        <ul>
            <li>Gebruik snake_case.</li>
            <li>Begin met de actie (create, update, add).</li>
            <li>Eindig met de tabelnaam (create_categories_table).</li>
        </ul>

        <h3 id="create-migration">Migration Aanmaken</h3>
        <p>Om een tabel aan te maken, gebruiken we de optie <code>--create</code>. Als je de naamgeving goed doet (zoals hieronder), herkent Laravel automatisch dat je een tabel wilt maken.</p>

        <pre><code class="language-bash">php artisan make:migration create_categories_table</code></pre>

        <p>Dit maakt een bestand aan in <code>database/migrations</code>. In dit bestand vind je twee methodes:</p>
        <ul>
            <li><strong>up():</strong> Wat er moet gebeuren als de migration wordt uitgevoerd (tabel maken).</li>
            <li><strong>down():</strong> Wat er moet gebeuren als de migration wordt teruggedraaid (tabel verwijderen).</li>
        </ul>

        <p>We passen de <code>up()</code> functie aan om een 'name' kolom toe te voegen:</p>

        <pre><code class="language-php">
public function up(): void
{
    Schema::create('categories', function (Blueprint $table) {
        $table->id(); // Standaard primary key
        $table->string('name', 100); // Varchar(100)
        $table->timestamps(); // created_at & updated_at
    });
}
        </code></pre>

        <h3 id="run-migration">Migration Uitvoeren</h3>
        <p>Om de tabel daadwerkelijk in de database te zetten, voer je het volgende commando uit:</p>

        <pre><code class="language-bash">php artisan migrate</code></pre>

        <h3 id="string-length-error">Foutmelding: Key too long?</h3>
        <p>Krijg je een error zoals <em>"Specified key was too long"</em>? Dit komt vaak voor bij oudere MySQL versies in combinatie met Laravel. Je kunt dit oplossen in de <code>AppServiceProvider</code>.</p>
        <p>Ga naar <code>app/Providers/AppServiceProvider.php</code> en pas de boot methode aan:</p>

        <pre><code class="language-php">
use Illuminate\Support\Facades\Schema; // Vergeet deze niet bovenaan!

public function boot(): void
{
    Schema::defaultStringLength(191);
}
        </code></pre>
        <p>Voer daarna <code>php artisan migrate:fresh</code> uit om opnieuw te beginnen.</p>

        <h2 id="updating-migrations">Tabellen Wijzigen</h2>
        <p>Stel je wilt de lengte van de naam aanpassen van 100 naar 75 tekens. Pas <strong>nooit</strong> een bestaande migration aan die al uitgevoerd is (zeker niet in een team!). Maak in plaats daarvan een nieuwe migration.</p>

        <pre><code class="language-bash">php artisan make:migration --table=categories update_categories_table</code></pre>

        <p>In de nieuwe migration beschrijf je de wijziging:</p>

        <pre><code class="language-php">
public function up(): void
{
    Schema::table('categories', function (Blueprint $table) {
        $table->string('name', 75)->change();
    });
}

public function down(): void
{
    Schema::table('categories', function (Blueprint $table) {
        $table->string('name', 100)->change(); // Terug naar origineel
    });
}
        </code></pre>

        <p><em>Let op: Voor <code>->change()</code> heb je soms de package <code>doctrine/dbal</code> nodig, afhankelijk van je Laravel versie.</em></p>
        <p>Voer daarna weer <code>php artisan migrate</code> uit om de wijziging toe te passen.</p>

    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../script.js"></script>
</body>
</html>