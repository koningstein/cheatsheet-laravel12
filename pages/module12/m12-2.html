<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Excel Import & Export - Services & Features - Laravel 12</title>
    <link rel="stylesheet" href="../../style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="../../script.js" defer></script>
</head>
<body>
<div class="top-bar"><div class="top-bar-content"><div class="nav-group"><a href="../module11/m11-7.html">« Security & Auth</a><a href="../module13/m13-1.html">Quality Assurance »</a></div><div class="nav-group theme-switcher"><select id="theme-switcher"><option value="blue">Blauw</option></select></div></div></div>

<div class="container">
    <div class="header-nav-block">
        <header>
            <h1>Services & Features</h1>
            <p>Externe integraties, bestandsbeheer en systeemtaken.</p>
        </header>
        <nav>
            <ul>
                <li><a href="m12-1.html">PDF Generatie</a></li>
                <li><a href="m12-2.html" class="active">Excel Import & Export</a></li>
                <li><a href="m12-3.html">Mail & Notifications</a></li>
                <li><a href="m12-4.html">File Storage</a></li>
                <li><a href="m12-5.html">HTTP Client</a></li>
                <li><a href="m12-6.html">Events & Listeners</a></li>
                <li><a href="m12-7.html">Artisan Commands</a></li>
            </ul>
        </nav>
    </div>

    <main>
        <h2>Excel Integratie</h2>
        <p>Voor veel bedrijven draait de wereld om spreadsheets. Klanten willen rapportages kunnen downloaden om ze zelf te analyseren, of ze willen grote hoeveelheden data (zoals een nieuwe prijslijst) in één keer uploaden. De standaard package hiervoor is <strong>Laravel Excel</strong> (<code>maatwebsite/excel</code>).</p>

        <h3>Waarom: Separation of Concerns</h3>
        <p>Je zou de logica om een CSV te bouwen in je controller kunnen schrijven, maar dat wordt snel rommelig. Laravel Excel introduceert <strong>Export Classes</strong> en <strong>Import Classes</strong>. Hierdoor blijft je controller schoon en is de Excel-logica herbruikbaar.</p>

        <h3>Hoe: Data Exporteren</h3>
        <p>Eerst maak je een Export class aan: <code>php artisan make:export UsersExport --model=User</code>. In deze class definieer je wat er in de Excel moet komen.</p>

        <div class="note-box">Bestand: <code>app/Exports/UsersExport.php</code></div>
        <pre><code class="language-php">
namespace App\Exports;

use App\Models\User;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;

// De interfaces bepalen de functionaliteit (bijv. wel/geen headers)
class UsersExport implements FromCollection, WithHeadings
{
    public function collection()
    {
        // Selecteer alleen de kolommen die je wilt tonen
        return User::select('name', 'email', 'created_at')->get();
    }

    public function headings(): array
    {
        return ['Naam', 'E-mailadres', 'Lid sinds'];
    }
}
        </code></pre>

        <p>In je controller roep je deze class vervolgens aan om de download te starten.</p>

        <div class="note-box">Bestand: <code>app/Http/Controllers/UserController.php</code></div>
        <pre><code class="language-php">
use App\Exports\UsersExport;
use Maatwebsite\Excel\Facades\Excel;

public function export()
{
    return Excel::download(new UsersExport, 'users.xlsx');
}
        </code></pre>

        <h3>Hoe: Data Importeren</h3>
        <p>Importeren is complexer omdat je data moet valideren en verwerken. Maak een Import class: <code>php artisan make:import UsersImport --model=User</code>.</p>

        <div class="note-box">Bestand: <code>app/Imports/UsersImport.php</code></div>
        <pre><code class="language-php">
use App\Models\User;
use Maatwebsite\Excel\Concerns\ToModel;
use Maatwebsite\Excel\Concerns\WithHeadingRow; // Sla de eerste regel over

class UsersImport implements ToModel, WithHeadingRow
{
    public function model(array $row)
    {
        // $row bevat de data uit één regel van de Excel
        return new User([
            'name'     => $row['naam'], // matcht met kolomkop in excel
            'email'    => $row['email'],
            'password' => bcrypt('welkom123'),
        ]);
    }
}
        </code></pre>

        <p>De controller handelt de upload af en start de import:</p>

        <div class="note-box">Bestand: <code>app/Http/Controllers/UserController.php</code></div>
        <pre><code class="language-php">
use App\Imports\UsersImport;

public function import(Request $request)
{
    $request->validate(['file' => 'required|mimes:xlsx,csv']);

    Excel::import(new UsersImport, $request->file('file'));

    return redirect()->back()->with('success', 'Gebruikers geïmporteerd!');
}
        </code></pre>
    </main>
</div>
<footer><div class="footer-content"><p>&copy; 2025 Techniek College Rotterdam</p></div></footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>